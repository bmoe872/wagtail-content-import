<script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('[data-content-import-picker="microsoft"]').forEach(function (element) {
            let microsoftPicker = new MicrosoftPicker({
                appId: '{{ app_id|escapejs }}',
                clientId: '{{ client_id|escapejs }}',
                pickerApiKey: '{{ picker_api_key|escapejs }}',
            }, element.dataset.createPageUrl, '{{ csrf_token|escapejs }}');

            element.addEventListener('click', function(e) {
                e.preventDefault();
                microsoftPicker.show();
            });
        });
    });
</script>
